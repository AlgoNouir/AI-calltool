# ğŸ§  Agent Class â€” Intelligent Tool-Using LLM Agent

## ğŸ“˜ Ø®Ù„Ø§ØµÙ‡

Ú©Ù„Ø§Ø³ `Agent` Ù†Ù…Ø§ÛŒÙ†Ø¯Ù‡ ÛŒÚ© Ù…ÙˆØ¬ÙˆØ¯ÛŒØª Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø± Ù¾Ø§ÛŒÙ‡ LLM Ø§Ø³Øª Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯:

* Ø¨Ø± Ø§Ø³Ø§Ø³ ÛŒÚ© Ø³ÛŒØ³ØªÙ… Ù¾Ø±Ø§Ù…Ù¾Øª (prompt) ÙÚ©Ø± Ú©Ù†Ø¯ Ùˆ Ù¾Ø§Ø³Ø® Ø¯Ù‡Ø¯
* Ù…ØªØ¯Ù‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ Ø®ÙˆØ¯Ø´ Ø±Ø§ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Â«Ø§Ø¨Ø²Ø§Ø±Â» Ù…Ø¹Ø±ÙÛŒ Ú©Ù†Ø¯
* Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ØŒ Ø¹Ù…Ù„Ú©Ø±Ø¯Ù‡Ø§ÛŒ Ù¾ÛŒÚ†ÛŒØ¯Ù‡â€ŒØªØ±ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡Ø¯
* Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ø§Ø² Ù…Ø¯Ù„ Ø²Ø¨Ø§Ù†ÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ØŒ ØªØ­Ù„ÛŒÙ„ Ùˆ ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ø¯

---

## âœ… Ú©Ø§Ø±Ø¨Ø±Ø¯ Ø§ØµÙ„ÛŒ

* ØªØ¹Ø±ÛŒÙ AgentÙ‡Ø§ÛŒ ØªØ®ØµØµÛŒ Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ (Ø¨Ø§ Ù…ØªØ¯Ù‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡)
* ØªØ¨Ø¯ÛŒÙ„ Ù‡Ø± Agent Ø¨Ù‡ ÛŒÚ© LLMChain Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª ØªØ¹Ø§Ù…Ù„ Ù…ØªÙ†ÛŒ
* Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ Ø¨Ø§ Ø³Ø§Ø®ØªØ§Ø± JSON Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø®Ø§Øµ
* ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø² Ù…ÛŒØ§Ù† Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§

---

## âš™ï¸ Ø³Ø§Ø²Ù†Ø¯Ù‡

```python
def __init__(self, mainText: str, modelName: str, maxRetray=3, baseUrl="http://localhost:11434")
```

| Ù¾Ø§Ø±Ø§Ù…ØªØ±     | ØªÙˆØ¶ÛŒØ­                                                    |
| ----------- | -------------------------------------------------------- |
| `mainText`  | ØªÙˆØ¶ÛŒØ­ Ù†Ù‚Ø´ AgentØŒ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø¨Ø®Ø´ Ø§ØµÙ„ÛŒ system prompt         |
| `modelName` | Ù†Ø§Ù… Ù…Ø¯Ù„ LLM Ø¨Ø±Ø§ÛŒ Ù¾Ø§Ø³Ø®â€ŒØ¯Ù‡ÛŒ (Ù…Ø«Ù„ `mistral`, `llama3`, ...) |
| `maxRetray` | Ø­Ø¯Ø§Ú©Ø«Ø± ØªØ¹Ø¯Ø§Ø¯ ØªÙ„Ø§Ø´ Ø¨Ø±Ø§ÛŒ Ú¯Ø±ÙØªÙ† Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª Ù‡Ù†Ú¯Ø§Ù… Ø§Ù†ØªØ®Ø§Ø¨      |
| `baseUrl`   | Ø¢Ø¯Ø±Ø³ Ø³Ø±ÙˆÛŒØ³ LLM (Ù¾ÛŒØ´â€ŒÙØ±Ø¶: ollama Ù„ÙˆÚ©Ø§Ù„)                   |

---

## ğŸ§© Ø§Ø¬Ø²Ø§ÛŒ Ø§ØµÙ„ÛŒ

### ğŸ”¸ `self.chain`

ÛŒÚ© Ø²Ù†Ø¬ÛŒØ±Ù‡ LangChain Ú©Ù‡ Ø´Ø§Ù…Ù„:

1. `PromptTemplate` Ø¨Ø§ system prompt + Ø³Ø¤Ø§Ù„
2. `OllamaLLM` Ù…Ø¯Ù„ Ø²Ø¨Ø§Ù†ÛŒ
3. (Ø§Ø®ØªÛŒØ§Ø±ÛŒ) `JsonOutputParser` + Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ

---

### ğŸ”¸ `self._tools`

Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒÛŒ Ù‡Ø³ØªÙ†Ø¯ Ú©Ù‡ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ù…ØªØ¯Ù‡Ø§ÛŒ Ú©Ù„Ø§Ø³ (Ø¨Ø¯ÙˆÙ† underscore Ùˆ Ø¨Ø¯ÙˆÙ† override Ø§Ø² init) Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ Ùˆ Ø¨Ø§ Ø¯Ú©ÙˆØ±Ø§ØªÙˆØ± `@tool` Ø¨Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.

---

## ğŸ”§ Ù…ØªØ¯Ù‡Ø§ÛŒ Ù…Ù‡Ù…

### `message(message: str) -> str`

Ù¾Ø§Ø³Ø® Ø³Ø§Ø¯Ù‡â€ŒÛŒ LLM Ø¨Ù‡ ÛŒÚ© Ø³Ø¤Ø§Ù„:

```python
agent.message("Ø³Ù„Ø§Ù… Ú†Ø·ÙˆØ±ÛŒØŸ")
```

---

### `select(text: str, options: list | dict, think=False) -> str | None`

ÛŒÚ© Ú¯Ø²ÛŒÙ†Ù‡ Ø±Ø§ Ø¨Ø§ Ú©Ù…Ú© LLM Ø§Ø² Ø¨ÛŒÙ† Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

```python
agent.select("Ú©Ø¯Ø§Ù… Ø¹Ø¯Ø¯ Ø§ÙˆÙ„ Ø§Ø³ØªØŸ", ["9", "7", "10"])
# ÛŒØ§
agent.select("Ú©Ø¯Ø§Ù… Agent Ù…Ù†Ø§Ø³Ø¨â€ŒØªØ± Ø§Ø³ØªØŸ", {"0": "Ø±ÛŒØ§Ø¶ÛŒ", "1": "Ú†Øª"})
```

* Ø§Ú¯Ø± `think=True` Ø¨Ø§Ø´Ø¯ØŒ Ø¯Ø± ØµÙˆØ±Øª Ù¾Ø§Ø³Ø® Ù†Ø§Ù…Ø¹ØªØ¨Ø±ØŒ ØªÙ„Ø§Ø´ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

---

### `_invoke_tool(tool_call_request: ToolCallRequest) -> Any`

Ø§Ø¬Ø±Ø§ÛŒ ÛŒÚ© Ø§Ø¨Ø²Ø§Ø± Ø¨Ø§ Ø³Ø§Ø®ØªØ§Ø± JSON:

```python
agent._invoke_tool({
    "name": "calculate_sum",
    "arguments": {"a": 3, "b": 5}
})
```

* Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨ÛŒÙ† Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ Ø¬Ø³ØªØ¬Ùˆ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
* Ø§Ú¯Ø± Ø§Ø¨Ø²Ø§Ø±ÛŒ Ø¨Ø§ Ø¢Ù† Ù†Ø§Ù… Ù¾ÛŒØ¯Ø§ Ù†Ø´ÙˆØ¯ØŒ `"function not found"` Ø¨Ø§Ø²Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯.

---

### `_descibe_yourself() -> str`

ÛŒÚ© ØªÙˆØµÛŒÙ Ù…ØªÙ†ÛŒ Ø§Ø² Agent Ùˆ Ø³ÛŒØ³ØªÙ… Ù¾Ø±Ø§Ù…Ù¾Øª Ø¢Ù† Ø±Ø§ Ø¨Ø§Ø²Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯. Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ ØªÙˆØ³Ø· Orchestration Ú©Ø§Ø±Ø¨Ø±Ø¯ Ø¯Ø§Ø±Ø¯.

---

### `@property _tools`

Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ Ú©Ù„Ø§Ø³. Ù…ØªØ¯Ù‡Ø§ÛŒÛŒ Ú©Ù‡:

* Ø¨Ø§ \_ Ø´Ø±ÙˆØ¹ Ù†Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
* Ø¯Ø± `__dict__` Ù†Ø¨Ø§Ø´Ù†Ø¯
* Ø¯Ø± `self._ignoreFuncs` Ù†Ø¨Ø§Ø´Ù†Ø¯
  Ø¨Ù‡ ØµÙˆØ±Øª Ø§Ø¨Ø²Ø§Ø± Ø¯Ø±Ù†Ø¸Ø± Ú¯Ø±ÙØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.

---

## ğŸ§ª ØªØ¹Ø±ÛŒÙ Ø§Ø¨Ø²Ø§Ø± (Tool)

Ø¨Ø±Ø§ÛŒ Ø§Ø¶Ø§ÙÙ‡â€ŒÚ©Ø±Ø¯Ù† Ø§Ø¨Ø²Ø§Ø± Ø¨Ù‡ AgentØŒ Ú©Ø§ÙÛŒ Ø§Ø³Øª ÛŒÚ© Ù…ØªØ¯ ØªØ¹Ø±ÛŒÙ Ú©Ù†ÛŒØ¯ Ø¨Ø¯ÙˆÙ† underscoreØŒ Ù…Ø«Ù„Ø§Ù‹:

```python
def say_hello(self, name: str) -> str:
    return f"Hello {name}"
```

Ø§ÛŒÙ† Ù…ØªØ¯ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø± Agent Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø§Ø¨Ø²Ø§Ø± Ù‚Ø§Ø¨Ù„ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯ Ùˆ Ø¯Ø± prompt Ù†ÛŒØ² Ù…Ø¹Ø±ÙÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø§Ø² Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ø¯ Ø¨Ø§ÛŒØ¯ ÙØ§Ù†Ú©Ø´Ù† Ø±Ùˆ Ø¯Ø§Ø®Ù„ Ú©Ù„Ø§Ø³ Ø¨Ù†ÙˆÛŒØ³Ø¯.

---

## ğŸ›¡ï¸ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±


## ğŸ“ ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§

* `langchain`
* `langchain_ollama`
* `Ollama` backend ÙØ¹Ø§Ù„ (Ù„ÙˆÚ©Ø§Ù„ ÛŒØ§ remote)

---

## âœ¨ Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡

```python
from aaaai.agent import Agent


class MathAgent(Agent):

    # Ø§Ø¶Ø§ÙÙ‡â€ŒÚ©Ø±Ø¯Ù† Ø§Ø¨Ø²Ø§Ø± Ø¯Ù„Ø®ÙˆØ§Ù‡ Ø¨Ù‡ Ú©Ù„Ø§Ø³ Agent
    def calculate(self, x: int, y: int) -> int:
        """this function sum two numbers"""
        return x + y


agent = MathAgent("You are a math assistant.", modelName="mistral")

# Ù¾Ø§Ø³Ø® Ú¯Ø±ÙØªÙ† Ø§Ø² Ø·Ø±ÛŒÙ‚ Ù¾ÛŒØ§Ù… Ø³Ø§Ø¯Ù‡
print(agent.message("Hi, what is 2+2?"))

# ÛŒØ§ Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø± (Ù…Ø«Ù„Ø§Ù‹ Ø§Ø² Ø·Ø±ÛŒÙ‚ JsonOutputParser)
response = agent.message("Please use the calculate tool to add 3 and 5.")
print(response)
```

